
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>System Manipulation, Reduction, and Correction (system) &#8212; Vibration Testing 0.22 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.22',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Modal Analysis and System Identification (identification)" href="identification.html" />
    <link rel="prev" title="Signal Processing and Generation (signals)" href="signal.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-system">
<span id="system-manipulation-reduction-and-correction-system"></span><h1>System Manipulation, Reduction, and Correction (<a class="reference internal" href="#module-system" title="system"><code class="xref py py-mod docutils literal"><span class="pre">system</span></code></a>)<a class="headerlink" href="#module-system" title="Permalink to this headline">¶</a></h1>
<p>System manipulation, reduction, and corrections functions.</p>
<p>&#64;author: Joseph C. Slater</p>
<dl class="function">
<dt id="system.c2d">
<code class="descclassname">system.</code><code class="descname">c2d</code><span class="sig-paren">(</span><em>A</em>, <em>B</em>, <em>C</em>, <em>D</em>, <em>dt</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/system.html#c2d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#system.c2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert continuous state system to discrete time.</p>
<p>Converts a set of continuous state space system matrices to their
discrete counterpart.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>A, B, C, D</strong> : float arrays</p>
<blockquote>
<div><p>State space system matrices</p>
</div></blockquote>
<p><strong>dt</strong> : float</p>
<blockquote>
<div><p>Time step of discrete system</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>Ad, Bd, C, D</strong> : float arrays</p>
<blockquote class="last">
<div><p>Discrete state space system matrices</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Zero-order hold solution</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#system.d2c" title="system.d2c"><code class="xref py py-func docutils literal"><span class="pre">d2c()</span></code></a>.</p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vibrationtesting</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span><span class="p">,</span>   <span class="mf">0.</span> <span class="p">,</span>  <span class="mf">1.</span>    <span class="p">,</span>  <span class="mf">0.</span>    <span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span><span class="p">,</span>   <span class="mf">0.</span> <span class="p">,</span>  <span class="mf">0.</span>    <span class="p">,</span>  <span class="mf">1.</span>    <span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">1.4</span><span class="p">,</span>  <span class="mf">1.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0058</span><span class="p">,</span>  <span class="mf">0.0014</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">0.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.4</span><span class="p">,</span>  <span class="mf">0.0016</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0038</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span><span class="p">,</span>   <span class="mf">0.</span> <span class="p">,</span>  <span class="mf">1.</span>    <span class="p">,</span>  <span class="mf">0.</span>    <span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span> <span class="mf">0.</span><span class="p">,</span>   <span class="mf">0.</span> <span class="p">,</span>  <span class="mf">0.</span>    <span class="p">,</span>  <span class="mf">1.</span>    <span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="o">-</span><span class="mf">1.4</span><span class="p">,</span>  <span class="mf">1.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0058</span><span class="p">,</span>  <span class="mf">0.0014</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span> <span class="mf">0.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.4</span><span class="p">,</span>  <span class="mf">0.0016</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0038</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span> <span class="mf">0.</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span> <span class="mf">0.</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span> <span class="mf">1.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">1.4</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0058</span><span class="p">,</span> <span class="mf">0.0014</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">0.2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Ad</span><span class="p">,</span> <span class="n">Bd</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">c2d</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Ad</span><span class="p">)</span>
<span class="go">[[ 0.9999  0.0001  0.01    0.    ]</span>
<span class="go"> [ 0.      0.9999  0.      0.01  ]</span>
<span class="go"> [-0.014   0.012   0.9999  0.0001]</span>
<span class="go"> [ 0.008  -0.014   0.0001  0.9999]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Bd</span><span class="p">)</span>
<span class="go">[[ 0.  ]</span>
<span class="go"> [ 0.  ]</span>
<span class="go"> [ 0.  ]</span>
<span class="go"> [ 0.01]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="system.d2c">
<code class="descclassname">system.</code><code class="descname">d2c</code><span class="sig-paren">(</span><em>Ad</em>, <em>Bd</em>, <em>C</em>, <em>D</em>, <em>dt</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/system.html#d2c"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#system.d2c" title="Permalink to this definition">¶</a></dt>
<dd><p>Return continuous A, B, C, D from discrete form.</p>
<p>Converts a set of digital state space system matrices to their
continuous counterpart.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>Ad, Bd, C, D</strong> : float arrays</p>
<blockquote>
<div><p>Discrete state space system matrices</p>
</div></blockquote>
<p><strong>dt</strong> : float</p>
<blockquote>
<div><p>Time step of discrete system</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>A, B, C, D</strong> : float arrays</p>
<blockquote class="last">
<div><p>State space system matrices</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Zero-order hold solution</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">discrepancies between <a class="reference internal" href="#system.c2d" title="system.c2d"><code class="xref py py-func docutils literal"><span class="pre">c2d()</span></code></a> and <a class="reference internal" href="#system.d2c" title="system.d2c"><code class="xref py py-func docutils literal"><span class="pre">d2c()</span></code></a> are due to typing truncation errors.</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#system.c2d" title="system.c2d"><code class="xref py py-func docutils literal"><span class="pre">c2d()</span></code></a>.</p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vibrationtesting</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Ad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">0.9999</span><span class="p">,</span><span class="mf">0.0001</span><span class="p">,</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">0.</span><span class="p">],</span>
<span class="gp">... </span>               <span class="p">[</span> <span class="mf">0.</span><span class="p">,</span><span class="mf">0.9999</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.01</span><span class="p">],</span>
<span class="gp">... </span>               <span class="p">[</span><span class="o">-</span><span class="mf">0.014</span><span class="p">,</span><span class="mf">0.012</span><span class="p">,</span><span class="mf">0.9999</span><span class="p">,</span><span class="mf">0.0001</span><span class="p">],</span>
<span class="gp">... </span>               <span class="p">[</span> <span class="mf">0.008</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.014</span><span class="p">,</span><span class="mf">0.0001</span><span class="p">,</span><span class="mf">0.9999</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>               <span class="p">[</span> <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>               <span class="p">[</span> <span class="mf">0.</span>  <span class="p">],</span>
<span class="gp">... </span>               <span class="p">[</span> <span class="mf">0.01</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">1.4</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0058</span><span class="p">,</span> <span class="mf">0.0014</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">0.2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">d2c</span><span class="p">(</span><span class="n">Ad</span><span class="p">,</span> <span class="n">Bd</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">[[-0.003   0.004   1.0001 -0.0001]</span>
<span class="go"> [-0.004  -0.003  -0.      1.0001]</span>
<span class="go"> [-1.4001  1.2001 -0.003   0.004 ]</span>
<span class="go"> [ 0.8001 -1.4001  0.006  -0.003 ]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="system.damp">
<code class="descclassname">system.</code><code class="descname">damp</code><span class="sig-paren">(</span><em>A</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/system.html#damp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#system.damp" title="Permalink to this definition">¶</a></dt>
<dd><p>Display natural frequencies and damping ratios of state matrix.</p>
</dd></dl>

<dl class="function">
<dt id="system.guyan">
<code class="descclassname">system.</code><code class="descname">guyan</code><span class="sig-paren">(</span><em>M</em>, <em>K</em>, <em>master=None</em>, <em>fraction=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/system.html#guyan"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#system.guyan" title="Permalink to this definition">¶</a></dt>
<dd><p>Guyan reduced model.</p>
<p>Applies Guyan Reductions to second order system of equations of the form</p>
<div class="math">
\[M \ddot{x} + K x = 0\]</div>
<p>which are reduced to the form</p>
<div class="math">
\[M_r \ddot{x}_m + K_r x_m = 0\]</div>
<p>where</p>
<div class="math">
\[ \begin{align}\begin{aligned}x = T x_m\\M_r= T^T M T\\K_r= T^T K T\end{aligned}\end{align} \]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>M, K</strong> : float arrays</p>
<blockquote>
<div><p>Mass and Stiffness matrices</p>
</div></blockquote>
<p><strong>master</strong> : float array or list, optional</p>
<blockquote>
<div><p>List of retained degrees of freedom (0 indexing)</p>
</div></blockquote>
<p><strong>fraction</strong> : float, optional</p>
<blockquote>
<div><p>Fraction of degrees of freedom (0&lt; <cite>fraction</cite> &lt;1.0) to retain in model.
If both master and fraction are neglected, fraction is set to 0.25.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>Mred, Kred, T</strong> : float arrays</p>
<blockquote>
<div><p>Reduced Mass matric, Reduced Stiffness matrix, Transformation matrix</p>
</div></blockquote>
<p><strong>master_dofs</strong> : int list</p>
<blockquote>
<div><p>List of master degrees of freedom (0 indexing)</p>
</div></blockquote>
<p><strong>truncated_dofs</strong> : int list</p>
<blockquote class="last">
<div><p>List of truncated degrees of freedom (0 indexing)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Reduced coordinate system forces can be obtained by <cite>Fr = T.T &#64; F</cite>.</p>
<p>Reduced damping matrix can be obtained using <cite>Cr = T.T &#64; C &#64; T</cite>.</p>
<p>If mode shapes are obtained for the reduced system, full system mode shapes
are <cite>phi = T &#64; phi_r</cite>.</p>
<p>Code is not as efficient as possible. Using block submatrices would be
more efficient.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vibrationtesting</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Mred</span><span class="p">,</span> <span class="n">Kred</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">master</span><span class="p">,</span> <span class="n">truncated_dofs</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">guyan</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">fraction</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="system.improved_reduction">
<code class="descclassname">system.</code><code class="descname">improved_reduction</code><span class="sig-paren">(</span><em>M</em>, <em>K</em>, <em>master=None</em>, <em>fraction=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/system.html#improved_reduction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#system.improved_reduction" title="Permalink to this definition">¶</a></dt>
<dd><p>Incomplete.</p>
<p>4.14 Friswell</p>
</dd></dl>

<dl class="function">
<dt id="system.mode_expansion_from_model">
<code class="descclassname">system.</code><code class="descname">mode_expansion_from_model</code><span class="sig-paren">(</span><em>Psi</em>, <em>omega</em>, <em>M</em>, <em>K</em>, <em>measured</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/system.html#mode_expansion_from_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#system.mode_expansion_from_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Deflection extrapolation to full FEM model coordinates, matrix method.</p>
<p>Provided an equation  of the form:</p>
<p><span class="math">\(\begin{pmatrix}-\begin{bmatrix}M_{mm}&amp;M_{mu}\\ M_{um}&amp;M_{uu}
\end{bmatrix} \omega_i^2
+\begin{bmatrix}K_{mm}&amp;K_{mu}\\ K_{um}&amp;K_{uu}\end{bmatrix}\end{pmatrix}\)</span>
<span class="math">\(\begin{bmatrix}\Psi_{i_m}\\ \Psi_{i_u}\end{bmatrix}= 0\)</span></p>
<p>Where:</p>
<ul class="simple">
<li><span class="math">\(M\)</span> and <span class="math">\(K\)</span> are the mass and stiffness matrices, likely from
a finite element model</li>
<li><span class="math">\(\Psi_i\)</span> and <span class="math">\(\omega_i\)</span> represent a mode/frequency pair</li>
<li>subscripts <span class="math">\(m\)</span> and <span class="math">\(u\)</span> represent measure and unmeasured
of the mode</li>
</ul>
<p>Determines the unknown portion of the mode (or operational deflection)
shape, <span class="math">\(\Psi_{i_u}\)</span> by
direct algebraic solution, aka</p>
<p><span class="math">\(\Psi_{i_u} = - (K_{uu}- M_{ss} \omega_i^2) ^{-1}
(K_{um}-M_{um}\omega_i^2)\Psi_{i_m}\)</span></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>Psi</strong> : float array</p>
<blockquote>
<div><p>mode shape or shapes, 2-D array columns of which are mode shapes</p>
</div></blockquote>
<p><strong>omega</strong> : float or 1-D float array</p>
<blockquote>
<div><p>natural (or driving) frequencies</p>
</div></blockquote>
<p><strong>M, K</strong> : float arrays</p>
<blockquote>
<div><p>Mass and Stiffness matrices</p>
</div></blockquote>
<p><strong>measured</strong> : float or integer array or list</p>
<blockquote>
<div><p>List of measured degrees of freedom (0 indexed)</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>Psi_full</strong> : float array</p>
<blockquote class="last">
<div><p>Complete mode shape</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">incomplete multi-mode update. Would require each at a
different frequency.</p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vibrationtesting</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">measured</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">omega</span><span class="p">,</span> <span class="n">zeta</span><span class="p">,</span> <span class="n">Psi</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sos_modal</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Psi_measured</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">0.15</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.37</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Psi_full</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">mode_expansion_from_model</span><span class="p">(</span><span class="n">Psi_measured</span><span class="p">,</span> <span class="n">omega</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">M</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span>
<span class="gp">... </span><span class="n">measured</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">Psi</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">Psi_full</span><span class="p">)))</span>
<span class="go">[[-0.164  -0.15  ]</span>
<span class="go"> [-0.2955  0.2886]</span>
<span class="go"> [-0.3685 -0.37  ]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="system.model_correction_direct">
<code class="descclassname">system.</code><code class="descname">model_correction_direct</code><span class="sig-paren">(</span><em>Psi</em>, <em>omega</em>, <em>M</em>, <em>K</em>, <em>method='Baruch'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/system.html#model_correction_direct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#system.model_correction_direct" title="Permalink to this definition">¶</a></dt>
<dd><p>Direct model updating using model data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>Psi</strong> : float array</p>
<blockquote>
<div><p>Expanded mode shapes from experimental measurements. Must be
real-valued. See <cite>mode_expansion_from_model</cite>.</p>
</div></blockquote>
<p><strong>omega</strong> : float array</p>
<blockquote>
<div><p>Natural frequencies identified from modal analysis (diagonal matrix or
vector).</p>
</div></blockquote>
<p><strong>M, K</strong> : float arrays</p>
<blockquote>
<div><p>Analytical mass and stiffness matrices</p>
</div></blockquote>
<p><strong>method</strong> : string, optional</p>
<blockquote>
<div><p><cite>Baruch</cite> and Bar-Itzhack <a class="reference internal" href="#r12" id="id1">[R12]</a> or <cite>Berman</cite> and Nagy <a class="reference internal" href="#r22" id="id2">[R22]</a>
(default Baruch)</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>Mc, Kc</strong> : float arrays</p>
<blockquote class="last">
<div><p>Corrected mass and stiffness matrices.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<table class="docutils citation" frame="void" id="r12" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[R12]</a></td><td>Baruch, M. and Bar-Itzhack, I.Y., “Optimal Weighted
Orthogonalization of Measured Modes,” <em>AIAA Journal</em>, 16(4), 1978, pp.
346-351.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r22" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[R22]</a></td><td>Berman, A. and Nagy, E.J., 1983, “Improvements of a Large Analytical
Model using Test Data,” <em>AIAA Journal</em>, 21(8), 1983, pp. 1168-1173.</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="system.real_modes">
<code class="descclassname">system.</code><code class="descname">real_modes</code><span class="sig-paren">(</span><em>Psi</em>, <em>autorotate=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/system.html#real_modes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#system.real_modes" title="Permalink to this definition">¶</a></dt>
<dd><p>Real modes from complex modes.</p>
<p>Assuming a transformation</p>
<div class="math">
\[Psi_{real} = Psi_{complex} T\]</div>
<p>exists, where <span class="math">\(T\)</span> is a complex transformation matrix, find
<span class="math">\(Psi_{real}\)</span> using linear algebra.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>Psi</strong> : complex float array</p>
<blockquote>
<div><p>Complex mode shapes (displacement)</p>
</div></blockquote>
<p><strong>autorotate</strong> : Boolean, optional</p>
<blockquote>
<div><p>Attempt to rotate to near-real first</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>Psi</strong> : float array</p>
<blockquote class="last">
<div><p>Real modes</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Rotation of modes should be performed to get them as close to real
as possible first.</p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vibrationtesting</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Cso</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">.</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Ca</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Cd</span> <span class="o">=</span> <span class="n">Cv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">Ca</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">so2ss</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">Cso</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">Bt</span><span class="p">,</span> <span class="n">Cd</span><span class="p">,</span> <span class="n">Cv</span><span class="p">,</span> <span class="n">Ca</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Am</span><span class="p">,</span> <span class="n">Bm</span><span class="p">,</span> <span class="n">Cm</span><span class="p">,</span> <span class="n">Dm</span><span class="p">,</span> <span class="n">eigenvalues</span><span class="p">,</span> <span class="n">modes</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">ss_modal</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Psi</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">real_modes</span><span class="p">(</span><span class="n">modes</span><span class="p">[:,</span><span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="system.rsolve">
<code class="descclassname">system.</code><code class="descname">rsolve</code><span class="sig-paren">(</span><em>B</em>, <em>C</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/system.html#rsolve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#system.rsolve" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve right Gauss elimination equation.</p>
<p>Given <span class="math">\(A B  = C\)</span> return <span class="math">\(A = C B^{-1}\)</span></p>
<p>This uses <cite>scipy.linalg.solve</cite> with a little matrix manipulation first.
All keyword arguments of <cite>scipy.linalg.solve</cite> may be used.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>B, C</strong> : float arrays</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>A</strong> : float array</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><cite>scipy.linalg.solve</cite></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vibrationtesting</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span>  <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span>  <span class="mi">4</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">32</span><span class="p">,</span> <span class="o">-</span><span class="mi">16</span><span class="p">,</span>   <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>           <span class="p">[</span><span class="o">-</span><span class="mi">16</span><span class="p">,</span>  <span class="mi">36</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">],</span>
<span class="gp">... </span>           <span class="p">[</span>  <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">24</span><span class="p">,</span>  <span class="mi">20</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">rsolve</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">rsolve</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">)))</span>
<span class="go">[[ 4.  0.  0.]</span>
<span class="go"> [-0.  4. -1.]</span>
<span class="go"> [ 0. -1.  4.]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="system.serep">
<code class="descclassname">system.</code><code class="descname">serep</code><span class="sig-paren">(</span><em>M</em>, <em>K</em>, <em>master</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/system.html#serep"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#system.serep" title="Permalink to this definition">¶</a></dt>
<dd><p>System Equivalent Reduction Expansion Process reduced model.</p>
<p>Reduce size of second order system of equations by SEREP processs while
returning expansion matrix</p>
<p>Equation of the form:
<span class="math">\(M \ddot{x} + K x = 0\)</span>
is reduced to the form
<span class="math">\(M_r \ddot{x}_m + Kr x_m = 0\)</span>
where <span class="math">\(x = T x_m\)</span>, <span class="math">\(M_r= T^T M T\)</span>, <span class="math">\(K_r= T^T K T\)</span></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>M, K</strong> : float arrays</p>
<blockquote>
<div><p>Mass and Stiffness matrices</p>
</div></blockquote>
<p><strong>master</strong> : float array or list</p>
<blockquote>
<div><p>List of retained degrees of freedom</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>Mred, Kred, T</strong> : float arrays</p>
<blockquote>
<div><p>Reduced Mass matric, reduced stiffness matrix, Transformation matrix</p>
</div></blockquote>
<p><strong>truncated_dofs</strong> : int list</p>
<blockquote class="last">
<div><p>List of truncated degrees of freedom, zero indexed</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Reduced coordinate system forces can be obtained by
<cite>Fr = T.T &#64; F</cite></p>
<p>Reduced damping matrix can be obtained using <cite>Cr = T.T*&#64; C &#64; T</cite>.</p>
<p>If mode shapes are obtained for the reduced system, full system mode shapes
are <cite>phi = T &#64; phi_r</cite></p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#system.guyan" title="system.guyan"><code class="xref py py-func docutils literal"><span class="pre">guyan()</span></code></a></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vibrationtesting</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">retained</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Mred</span><span class="p">,</span> <span class="n">Kred</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">truncated_dofs</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">serep</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">retained</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="system.slice">
<code class="descclassname">system.</code><code class="descname">slice</code><span class="sig-paren">(</span><em>Matrix</em>, <em>a</em>, <em>b</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/system.html#slice"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#system.slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Slice a matrix properly- like Octave.</p>
<p>Addresses the confounding inconsistency that <cite>M[a,b]</cite> acts differently if
<cite>a</cite> and <cite>b</cite> are the same length or different lengths.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>Matrix</strong> : float array</p>
<blockquote>
<div><p>Arbitrary array</p>
</div></blockquote>
<p><strong>a, b</strong> : int lists or arrays</p>
<blockquote>
<div><p>list of rows and columns to be selected from <cite>Matrix</cite></p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>Matrix</strong> : float array</p>
<blockquote class="last">
<div><p>Properly sliced matrix- no casting allowed.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="system.so2ss">
<code class="descclassname">system.</code><code class="descname">so2ss</code><span class="sig-paren">(</span><em>M</em>, <em>C</em>, <em>K</em>, <em>Bt</em>, <em>Cd</em>, <em>Cv</em>, <em>Ca</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/system.html#so2ss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#system.so2ss" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert second order system to state space.</p>
<p>Given second order linear matrix equation of the form
<span class="math">\(M\\ddot{x} + C \\dot{x} + K x= \\tilde{B} u\)</span>
and
<span class="math">\(y = C_d x + C_v \\dot{x} + C_a\\ddot{x}\)</span>
returns the state space form equations
<span class="math">\(\\dot{z} = A z + B u\)</span>,
<span class="math">\(y = C z + D u\)</span></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>M, C, K, Bt, Cd, Cv, Cd</strong> : float arrays</p>
<blockquote>
<div><p>Mass , damping, stiffness, input, displacement sensor, velocimeter,
and accelerometer matrices</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>A, B, C, D</strong> : float arrays</p>
<blockquote class="last">
<div><p>State matrices</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vibrationtesting</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Cd</span> <span class="o">=</span> <span class="n">Cv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Ca</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">Css</span><span class="p">,</span> <span class="n">D</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">so2ss</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">Bt</span><span class="p">,</span> <span class="n">Cd</span><span class="p">,</span> <span class="n">Cv</span><span class="p">,</span> <span class="n">Ca</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;A: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">A</span><span class="p">))</span>
<span class="go">A:  [[ 0.      0.      1.      0.    ]</span>
<span class="go"> [ 0.      0.      0.      1.    ]</span>
<span class="go"> [-1.4     1.2    -0.0058  0.0014]</span>
<span class="go"> [ 0.8    -1.4     0.0016 -0.0038]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;B: &#39;</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="go">B:  [[ 0. ]</span>
<span class="go"> [ 0. ]</span>
<span class="go"> [-0.2]</span>
<span class="go"> [ 0.4]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;C: &#39;</span><span class="p">,</span> <span class="n">Css</span><span class="p">)</span>
<span class="go">C:  [[-1.4     1.2    -0.0058  0.0014]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;D: &#39;</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>
<span class="go">D:  [[-0.2]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="system.sos_frf">
<code class="descclassname">system.</code><code class="descname">sos_frf</code><span class="sig-paren">(</span><em>M</em>, <em>C</em>, <em>K</em>, <em>Bt</em>, <em>Cd</em>, <em>Cv</em>, <em>Ca</em>, <em>omega_low</em>, <em>omega_high</em>, <em>in_index</em>, <em>out_index</em>, <em>num_freqs=1000</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/system.html#sos_frf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#system.sos_frf" title="Permalink to this definition">¶</a></dt>
<dd><p>Return FRF of second order system.</p>
<p>Given second order linear matrix equation of the form
<span class="math">\(M\\ddot{x} + C \\dot{x} + K x= \\tilde{B} u\)</span>
and
<span class="math">\(y = C_d x + C_v \\dot{x} + C_a\\ddot{x}\)</span>
converts to state space form and returns the requested frequency response
function</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>M, C, K, Bt, Cd, Cv, Cd</strong> : float arrays</p>
<blockquote>
<div><p>Mass, damping, stiffness, input, displacement sensor, velocimeter,
and accelerometer matrices</p>
</div></blockquote>
<p><strong>omega_low, omega_high</strong> : floats</p>
<blockquote>
<div><p>low and high frequencies for evaluation</p>
</div></blockquote>
<p><strong>in_index, out_index</strong> : ints</p>
<blockquote>
<div><p>input and output numbers (starting at 1)</p>
</div></blockquote>
<p><strong>num_freqs</strong> : int</p>
<blockquote>
<div><p>number of frequencies at which to return FRF</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>omega</strong> : float array</p>
<blockquote>
<div><p>frequency vector</p>
</div></blockquote>
<p><strong>H</strong> : float array</p>
<blockquote>
<div><p>frequency response function</p>
</div></blockquote>
<p>Examples not working for second order system</p>
<p class="last">Need to make one for second order expansion</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vibrationtesting</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span><span class="p">,</span>   <span class="mf">0.</span> <span class="p">,</span>  <span class="mf">1.</span>    <span class="p">,</span>  <span class="mf">0.</span>    <span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span> <span class="mf">0.</span><span class="p">,</span>   <span class="mf">0.</span> <span class="p">,</span>  <span class="mf">0.</span>    <span class="p">,</span>  <span class="mf">1.</span>    <span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="o">-</span><span class="mf">1.4</span><span class="p">,</span>  <span class="mf">1.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0058</span><span class="p">,</span>  <span class="mf">0.0014</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span> <span class="mf">0.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.4</span><span class="p">,</span>  <span class="mf">0.0016</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0038</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span> <span class="mf">0.</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span> <span class="mf">0.</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span> <span class="mf">1.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">1.4</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0058</span><span class="p">,</span> <span class="mf">0.0014</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">0.2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">omega</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">ssfrf</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">frfplot</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="n">H</span><span class="p">)</span> 
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="system.sos_modal">
<code class="descclassname">system.</code><code class="descname">sos_modal</code><span class="sig-paren">(</span><em>M</em>, <em>K</em>, <em>C=False</em>, <em>damp_diag=0.03</em>, <em>shift=1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/system.html#sos_modal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#system.sos_modal" title="Permalink to this definition">¶</a></dt>
<dd><p>Eigen analysis of proportionally damped system.</p>
<p>Optimally find mass normalized mode shapes and natural frequencies
of a system modelled by <span class="math">\(M\ddot{x}+Kx=0\)</span>.</p>
<p>If provided, obtain damping ratios presuming <span class="math">\(C\)</span> can be decoupled.</p>
<p>Provides a warning if diagonalization of damping matrix fails worse than
relative error of <cite>damp_diag</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>M, K</strong> : float arrays</p>
<blockquote>
<div><p>Mass and stiffness matrices</p>
</div></blockquote>
<p><strong>C</strong> : float array, optional</p>
<blockquote>
<div><p>Damping matrix</p>
</div></blockquote>
<p><strong>damp_diag</strong> : float, optional</p>
<blockquote>
<div><p>Maximum amount of off-diagonal error allowed in assuming C can be
diagonalized</p>
</div></blockquote>
<p><strong>shift</strong> : float, optional</p>
<blockquote>
<div><p>Shift used in eigensolution. Should be approximately equal to the first
non-zero eigenvalue.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>omega</strong> : float array (1xN)</p>
<blockquote>
<div><p>Vector of natural frequencies (rad/sec)</p>
</div></blockquote>
<p><strong>zeta</strong> : float array (1xN)</p>
<blockquote>
<div><p>Vector of damping ratios</p>
</div></blockquote>
<p><strong>Psi</strong> : float array (NxN)</p>
<blockquote class="last">
<div><p>Matrix of mass normalized mode shapes by column</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vibrationtesting</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">omega</span><span class="p">,</span> <span class="n">zeta</span><span class="p">,</span> <span class="n">Psi</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sos_modal</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">K</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span>
<span class="go">[ 0.445   1.247   1.8019]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Psi</span><span class="o">.</span><span class="n">T</span><span class="nd">@K@Psi</span><span class="p">)</span>
<span class="go">[[ 0.1981  0.     -0.    ]</span>
<span class="go"> [ 0.      1.555  -0.    ]</span>
<span class="go"> [-0.     -0.      3.247 ]]</span>
</pre></div>
</div>
<p>Check that it works for rigid body modes.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">K2</span> <span class="o">=</span> <span class="n">K</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="nd">@M</span><span class="o">*</span><span class="p">(</span><span class="n">Psi</span><span class="o">.</span><span class="n">T</span><span class="nd">@K@Psi</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">omega</span><span class="p">,</span> <span class="n">zeta</span><span class="p">,</span> <span class="n">Psi</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sos_modal</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">K2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span>
<span class="go">[ 0.      1.1649  1.7461]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Psi</span><span class="p">)</span>
<span class="go">[[-0.164   0.3685 -0.2955]</span>
<span class="go"> [-0.2955  0.164   0.3685]</span>
<span class="go"> [-0.3685 -0.2955 -0.164 ]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">Psi</span><span class="o">.</span><span class="n">T</span><span class="nd">@K2@Psi</span><span class="p">))</span>
<span class="go">[ 0.      1.3569  3.0489]</span>
</pre></div>
</div>
<p>How about non-proportional damping</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">C</span> <span class="o">=</span> <span class="n">K</span><span class="o">/</span><span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">C</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">omega</span><span class="p">,</span> <span class="n">zeta</span><span class="p">,</span> <span class="n">Psi</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">sos_modal</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">K2</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
<span class="go">Damping matrix cannot be completely diagonalized.</span>
<span class="go">Off diagonal error of 22%.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span>
<span class="go">[ 0.      1.1649  1.7461]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">zeta</span><span class="p">)</span>
<span class="go">[ 0.      0.1134  0.113 ]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Psi</span><span class="o">.</span><span class="n">T</span><span class="nd">@C@Psi</span><span class="p">)</span>
<span class="go">[[ 0.0413 -0.0483  0.0388]</span>
<span class="go"> [-0.0483  0.2641 -0.0871]</span>
<span class="go"> [ 0.0388 -0.0871  0.3946]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="system.ss_modal">
<code class="descclassname">system.</code><code class="descname">ss_modal</code><span class="sig-paren">(</span><em>A</em>, <em>B=None</em>, <em>C=None</em>, <em>D=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/system.html#ss_modal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#system.ss_modal" title="Permalink to this definition">¶</a></dt>
<dd><p>State space modes, frequencies, damping ratios, and modal matrices.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>A, B, C, D</strong> : float arrays</p>
<blockquote>
<div><p>State space system matrices</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>Am, Bm, Cm, Dm</strong> : float arrays</p>
<blockquote class="last">
<div><p>Modal state space system matrices</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vibrationtesting</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Cso</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">.</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>                <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Bt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Ca</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Cd</span> <span class="o">=</span> <span class="n">Cv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">Ca</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">so2ss</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">Cso</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">Bt</span><span class="p">,</span> <span class="n">Cd</span><span class="p">,</span> <span class="n">Cv</span><span class="p">,</span> <span class="n">Ca</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Am</span><span class="p">,</span> <span class="n">Bm</span><span class="p">,</span> <span class="n">Cm</span><span class="p">,</span> <span class="n">Dm</span><span class="p">,</span> <span class="n">eigenvalues</span><span class="p">,</span> <span class="n">modes</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">ss_modal</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Am</span><span class="o">+</span><span class="p">(</span><span class="mf">0.00001</span><span class="o">+</span><span class="mf">0.00001</span><span class="n">j</span><span class="p">))</span>
<span class="go">[[-0.0013+0.4451j  0.0000+0.j      0.0000+0.j      0.0000+0.j      0.0000+0.j</span>
<span class="go">   0.0000+0.j    ]</span>
<span class="go"> [ 0.0000+0.j     -0.0013-0.445j   0.0000+0.j      0.0000+0.j      0.0000+0.j</span>
<span class="go">   0.0000+0.j    ]</span>
<span class="go"> [ 0.0000+0.j      0.0000+0.j     -0.0068+1.247j   0.0000+0.j      0.0000+0.j</span>
<span class="go">   0.0000+0.j    ]</span>
<span class="go"> [ 0.0000+0.j      0.0000+0.j      0.0000+0.j     -0.0068-1.247j</span>
<span class="go">   0.0000+0.j      0.0000+0.j    ]</span>
<span class="go"> [ 0.0000+0.j      0.0000+0.j      0.0000+0.j      0.0000+0.j</span>
<span class="go">  -0.0044+1.8019j  0.0000+0.j    ]</span>
<span class="go"> [ 0.0000+0.j      0.0000+0.j      0.0000+0.j      0.0000+0.j      0.0000+0.j</span>
<span class="go">  -0.0044-1.8019j]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Cm</span><span class="p">)</span>
<span class="go">[[ 0.0594-0.0001j  0.0594+0.0001j  0.0039-0.717j   0.0039+0.717j</span>
<span class="go">   0.0241-0.9307j  0.0241+0.9307j]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="system.ssfrf">
<code class="descclassname">system.</code><code class="descname">ssfrf</code><span class="sig-paren">(</span><em>A</em>, <em>B</em>, <em>C</em>, <em>D</em>, <em>omega_low</em>, <em>omega_high</em>, <em>in_index</em>, <em>out_index</em>, <em>num_freqs=1000</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/system.html#ssfrf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#system.ssfrf" title="Permalink to this definition">¶</a></dt>
<dd><p>Return FRF of state space system.</p>
<p>Obtains the computed FRF of a state space system between selected input
and output over frequency range of interest.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>A, B, C, D</strong> : float arrays</p>
<blockquote>
<div><p>state system matrices</p>
</div></blockquote>
<p><strong>omega_low, omega_high</strong> : floats</p>
<blockquote>
<div><p>low and high frequencies for evaluation</p>
</div></blockquote>
<p><strong>in_index, out_index</strong> : ints</p>
<blockquote>
<div><p>input and output numbers (starting at 1)</p>
</div></blockquote>
<p><strong>num_freqs</strong> : int</p>
<blockquote>
<div><p>number of frequencies at which to return FRF</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>omega</strong> : float array</p>
<blockquote>
<div><p>frequency vector</p>
</div></blockquote>
<p><strong>H</strong> : float array</p>
<blockquote class="last">
<div><p>frequency response function</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">vibrationtesting</span> <span class="k">as</span> <span class="nn">vt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span><span class="p">,</span>   <span class="mf">0.</span> <span class="p">,</span>  <span class="mf">1.</span>    <span class="p">,</span>  <span class="mf">0.</span>    <span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span> <span class="mf">0.</span><span class="p">,</span>   <span class="mf">0.</span> <span class="p">,</span>  <span class="mf">0.</span>    <span class="p">,</span>  <span class="mf">1.</span>    <span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="o">-</span><span class="mf">1.4</span><span class="p">,</span>  <span class="mf">1.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0058</span><span class="p">,</span>  <span class="mf">0.0014</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span> <span class="mf">0.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.4</span><span class="p">,</span>  <span class="mf">0.0016</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0038</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span> <span class="mf">0.</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span> <span class="mf">0.</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span> <span class="mf">1.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">1.4</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0058</span><span class="p">,</span> <span class="mf">0.0014</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">0.2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">omega</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">vt</span><span class="o">.</span><span class="n">ssfrf</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vt</span><span class="o">.</span><span class="n">frfplot</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="n">H</span><span class="p">)</span> 
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Vibration Testing</a></h1>



<p class="blurb">Vibration Testing Analysis</p>






<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html">Tutorial</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="signal.html">Signal Processing and Generation (<code class="docutils literal"><span class="pre">signals</span></code>)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">System Manipulation, Reduction, and Correction (<code class="docutils literal"><span class="pre">system</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="identification.html">Modal Analysis and System Identification (<code class="docutils literal"><span class="pre">identification</span></code>)</a></li>
</ul>
</li>
</ul>


<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/reference/system.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Joseph C. Slater.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../_sources/reference/system.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-62100376-6']);
      _gaq.push(['_setDomainName', 'none']);
      _gaq.push(['_setAllowLinker', true]);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
    
  </body>
</html>